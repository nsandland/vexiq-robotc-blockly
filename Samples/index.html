<html>
  <head>
    <script>
      async function getDirectory(rootUrl) {
        const response = await fetch(rootUrl);
        const data = await response.json();
        let htmlString = '<ul>';
        for (let file of data) {
          if (file.type == 'dir') {
            htmlString += `<li>${file.name}`;
            htmlString += await getDirectory(file.url);
            htmlString += `</li>`;
          }
          else if (file.type == 'file' && file.name.endsWith('.c')) {
            let url = `../index.html?load=` + encodeURIComponent(file.html_url);
            htmlString += `<li><a href="${url}">${file.name}</a></li>`
          }
        }
        htmlString += '</ul>';
        return htmlString;         
      }

      (async () => {
        let htmlString = await getDirectory('https://api.github.com/repos/nsandland/vexiq-robotc-blockly/contents/Samples');
        document.getElementById('directory').innerHTML = htmlString;
      })()
    </script>
  </head>
  <body>
    <h1>Sample Programs for Blockly RobotC for VexIQ</h1>
    <div id="directory"></div>
  <body>
</html>